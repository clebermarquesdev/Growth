PROMPT â€” ImplementaÃ§Ã£o de AutenticaÃ§Ã£o PrÃ³pria (Free, No Domain, No Vendor Lock-in)
ğŸ¯ PAPEL DA IA

VocÃª atuarÃ¡ como:

Arquiteto de Software (SaaS)

Especialista em SeguranÃ§a Web

Backend Engineer

Product Engineer focado em MicroSaaS

Seu objetivo Ã© implementar um sistema de autenticaÃ§Ã£o completo, seguro, gratuito e que nÃ£o exija domÃ­nio pago, nem serviÃ§os proprietÃ¡rios de autenticaÃ§Ã£o.

ğŸ§© REQUISITOS OBRIGATÃ“RIOS

A soluÃ§Ã£o DEVE:

âŒ NÃƒO usar Replit Auth

âŒ NÃƒO usar Clerk

âŒ NÃƒO exigir domÃ­nio pago

âŒ NÃƒO exigir plano pago de terceiros

âœ… Funcionar em:

localhost

IP pÃºblico

subdomÃ­nios gratuitos (ex: *.repl.co, *.onrender.com, *.vercel.app)

âœ… Ser self-hosted

âœ… Ser segura (hash de senha, tokens, proteÃ§Ã£o bÃ¡sica)

ğŸ§  ESTRATÃ‰GIA DE AUTENTICAÃ‡ÃƒO (BASE)

Implemente Auth por Email + Senha, com:

Cadastro

Login

SessÃ£o persistente

Logout

ProteÃ§Ã£o de rotas

Sem OAuth no MVP (Google, etc.).

ğŸ§± STACK SUGERIDA (PODE AJUSTAR SE NECESSÃRIO)

Backend: Node.js + Express (ou equivalente)

Banco: PostgreSQL / SQLite / MongoDB

Hash: bcrypt

SessÃ£o: JWT (stateless)

Cookies: HttpOnly (se possÃ­vel)

âš ï¸ NÃ£o usar soluÃ§Ãµes SaaS de auth externas.

ğŸ” FLUXO DE AUTENTICAÃ‡ÃƒO
1ï¸âƒ£ Cadastro (Sign Up)

Email

Senha

ConfirmaÃ§Ã£o de senha

Regras:

Senha com hash (bcrypt)

ValidaÃ§Ã£o bÃ¡sica de email

Impedir emails duplicados

2ï¸âƒ£ Login

Email + Senha

VerificaÃ§Ã£o de hash

GeraÃ§Ã£o de JWT

JWT deve conter:

user_id

email

issued_at

expiraÃ§Ã£o

3ï¸âƒ£ PersistÃªncia de SessÃ£o

Armazenar JWT:

Preferencialmente em cookie HttpOnly

Alternativa: localStorage (explicar tradeoff)

4ï¸âƒ£ ProteÃ§Ã£o de Rotas

Middleware que:

Verifica token

Bloqueia acesso nÃ£o autenticado

Injeta user no request

5ï¸âƒ£ Logout

Remover token do cliente

Invalidar sessÃ£o local

ğŸ›¡ï¸ SEGURANÃ‡A MÃNIMA OBRIGATÃ“RIA

Implementar:

Hash de senha com bcrypt

JWT com expiraÃ§Ã£o curta

VariÃ¡veis de ambiente para secrets

Rate limit bÃ¡sico em login

Mensagens de erro genÃ©ricas (anti-enumeraÃ§Ã£o)

ğŸ§ª TESTES ESSENCIAIS

Cadastro com email vÃ¡lido

Login correto

Login invÃ¡lido

Acesso a rota protegida sem token

Logout funcionando

ğŸ“¦ ESTRUTURA DE PASTAS SUGERIDA
/auth
  â”œâ”€ auth.controller.ts
  â”œâ”€ auth.routes.ts
  â”œâ”€ auth.service.ts
  â”œâ”€ auth.middleware.ts
/models
  â””â”€ user.model.ts
/utils
  â””â”€ jwt.ts

ğŸ§  CONSIDERAÃ‡Ã•ES IMPORTANTES

NÃƒO implementar verificaÃ§Ã£o de email no MVP

NÃƒO usar cookies Secure-only (HTTPS obrigatÃ³rio) se estiver em ambiente local

Preparar o cÃ³digo para futura adiÃ§Ã£o de OAuth

ğŸ¯ SAÃDA ESPERADA DA IA

Ao final, vocÃª deve entregar:

Arquitetura da autenticaÃ§Ã£o

CÃ³digo funcional de:

Signup

Login

Middleware de proteÃ§Ã£o

InstruÃ§Ãµes claras para rodar localmente

ObservaÃ§Ãµes de seguranÃ§a

ğŸ§  NOTA FINAL (DECISÃƒO DE PRODUTO)

Este sistema Ã© suficiente, seguro e escalÃ¡vel para MVP.
OAuth e serviÃ§os externos sÃ³ devem entrar depois da validaÃ§Ã£o.